var g=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var i=(t,e,n)=>(g(t,e,"read from private field"),n?n.call(t):e.get(t)),f=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},w=(t,e,n,c)=>(g(t,e,"write to private field"),c?c.call(t,n):e.set(t,n),n);import"./modulepreload-polyfill-3cfb730f.js";var s;class m{constructor(){f(this,s,void 0);w(this,s,new Map)}on(e,n){i(this,s).has(e)||i(this,s).set(e,new Set),i(this,s).get(e).add(n)}off(e,n){i(this,s).has(e)&&i(this,s).get(e).delete(n)}emit(e,n){const c=i(this,s).get(e);if(c)for(const r of c)try{r(e,n)}catch(u){console.error(`Error in event listener: ${u}`)}}}s=new WeakMap;let o=null,b=1;const a=new m;function h(){o&&(o.close(),o=null),document.querySelector("#result").textContent=""}function p(t){console.log("Message received from server:",t),a.emit("websocket-message",JSON.parse(t.data))}function v(){h();const t=document.querySelector('input[name="url"]');let e="";t.value.includes("/session")?e=`ws://${t.value}`:e=`ws://${t.value}/session`,o=new WebSocket(e),o.onopen=n=>{console.log("WebSocket connection opened")},o.onmessage=p,o.onclose=n=>{console.log("WebSocket connection closed")}}const S=document.querySelector("#connect");S.addEventListener("click",v);function k(t){if(!o)return null;const e=b++;return t.id=e,console.log("Message sent to server:",t),o.send(JSON.stringify(t)),e}function l(t,e){const n=k({method:t,params:e});return new Promise(c=>{const r=(u,d)=>{d.id===n&&(a.off("websocket-message",r),c(d))};a.on("websocket-message",r)})}const x=document.querySelector("#navigate");x.addEventListener("click",async()=>{await l("session.new",{capabilities:{}});const t=await l("browsingContext.getTree",{});console.log("browsingContext.getTree",t);const e=t.result.contexts[0].context;await l("browsingContext.navigate",{context:e,url:"https://example.com",wait:"complete"})});
